(this["webpackJsonpray-dashboard-client"]=this["webpackJsonpray-dashboard-client"]||[]).push([[7],{514:function(e,a,t){"use strict";var n=t(438),r=t(485),l=t(0),c=t.n(l);a.a=function(e){var a=e.loading;return c.a.createElement(n.a,{open:a,style:{zIndex:100}},c.a.createElement(r.a,{color:"primary"}))}},517:function(e,a,t){"use strict";t.d(a,"b",(function(){return r})),t.d(a,"a",(function(){return l})),t.d(a,"c",(function(){return c}));var n=t(43),r=function(){return Object(n.b)("api/jobs/")},l=function(e){return Object(n.b)("jobs/".concat(e))},c=function(e){var a=e?"?job_id=".concat(e):"";return Object(n.b)("api/progress".concat(a))}},536:function(e,a,t){"use strict";t.r(a);var n=t(161),r=t(521),l=t(503),c=t(494),o=t(478),i=t(520),s=t(483),m=t(481),d=t(482),u=t(480),p=t(484),b=t(64),E=t.n(b),v=t(0),g=t.n(v),f=t(67),h=t(516),j=t(514),k=t(111),O=t(110),y=t(522),N=t(523),x=t(8),D=t.n(x),I=t(16),M=t(7),w=t(81),C=t(517),L=Object(n.a)((function(e){return{root:{padding:e.spacing(2)},paper:{padding:e.spacing(2),marginTop:e.spacing(2),marginBottom:e.spacing(2)},label:{fontWeight:"bold"},pageMeta:{padding:e.spacing(2),marginTop:e.spacing(2)},tab:{marginBottom:e.spacing(2)},dependenciesChip:{margin:e.spacing(.5),wordBreak:"break-all"},alert:{color:e.palette.error.main}}}));a.default=function(e){var a,t,n,b=L(),x=function(e){var a=e.match.params,t=Object(v.useState)(),n=Object(M.a)(t,2),r=n[0],l=n[1],c=Object(v.useState)("Loading the job detail"),o=Object(M.a)(c,2),i=o[0],s=o[1],m=Object(v.useState)(!0),d=Object(M.a)(m,2),u=d[0],p=d[1],b=Object(v.useState)("info"),E=Object(M.a)(b,2),g=E[0],f=E[1],h=Object(v.useContext)(w.a).ipLogMap,j=Object(v.useRef)(),k=Object(v.useCallback)(Object(I.a)(D.a.mark((function e(){var t,n,r,c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(C.a)(a.id);case 4:c=e.sent,(null===(t=c.data)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.detail)&&l(c.data.data.detail),(null===(r=c.data)||void 0===r?void 0:r.msg)&&s(c.data.msg||""),!1===c.data.result&&(s("Job Query Error Please Check JobId"),l(void 0),p(!1)),j.current=setTimeout(k,4e3);case 9:case"end":return e.stop()}}),e)}))),[u,a.id]);Object(v.useEffect)((function(){return j.current&&clearTimeout(j.current),k(),function(){j.current&&clearTimeout(j.current)}}),[k]);var O=(r||{}).jobInfo;return{actorMap:null===r||void 0===r?void 0:r.jobActors,jobInfo:O,job:r,msg:i,selectedTab:g,handleChange:function(e,a){f(a)},handleSwitchChange:function(e){p(e.target.checked)},params:a,refreshing:u,ipLogMap:h}}(e),T=x.actorMap,A=x.jobInfo,S=x.job,J=x.msg,W=x.selectedTab,Y=x.handleChange,P=x.handleSwitchChange,R=x.params,B=x.refreshing,H=x.ipLogMap;return S&&A?g.a.createElement("div",{className:b.root},g.a.createElement(O.a,{title:"JOB - ".concat(R.id)},g.a.createElement(k.a,{type:"job",status:A.isDead?"DEAD":"ALIVE"}),g.a.createElement("br",null),"Auto Refresh:",g.a.createElement(r.a,{checked:B,onChange:P,name:"refresh",inputProps:{"aria-label":"secondary checkbox"}}),g.a.createElement("br",null),"Request Status: ",J," ",g.a.createElement("br",null)),g.a.createElement(O.a,{title:"Job Detail"},g.a.createElement(l.a,{value:W,onChange:Y,className:b.tab},g.a.createElement(c.a,{value:"info",label:"Info"}),g.a.createElement(c.a,{value:"dep",label:"Dependencies"}),g.a.createElement(c.a,{value:"worker",label:"Worker(".concat((null===S||void 0===S||null===(a=S.jobWorkers)||void 0===a?void 0:a.length)||0,")")}),g.a.createElement(c.a,{value:"actor",label:"Actor(".concat(Object.entries((null===S||void 0===S?void 0:S.jobActors)||{}).length||0,")")})),"info"===W&&g.a.createElement(o.a,{container:!0,spacing:2},g.a.createElement(o.a,{item:!0,xs:4},g.a.createElement("span",{className:b.label},"Driver IP"),":"," ",A.driverIpAddress),H[A.driverIpAddress]&&g.a.createElement(o.a,{item:!0,xs:4},g.a.createElement("span",{className:b.label},"Driver Log"),":"," ",g.a.createElement(f.b,{to:"/log/".concat(encodeURIComponent(H[A.driverIpAddress]),"?fileName=driver-").concat(A.jobId),target:"_blank"},"Log")),g.a.createElement(o.a,{item:!0,xs:4},g.a.createElement("span",{className:b.label},"Driver Pid"),":"," ",A.driverPid),g.a.createElement(o.a,{item:!0,xs:4},g.a.createElement("span",{className:b.label},"StartTime"),":"," ",E()(Number(A.startTime)).format("YYYY/MM/DD HH:mm:ss")),g.a.createElement(o.a,{item:!0,xs:4},g.a.createElement("span",{className:b.label},"EndTime"),":"," ",A.endTime>0?E()(Number(A.endTime)).format("YYYY/MM/DD HH:mm:ss"):"-"),A.eventUrl&&g.a.createElement(o.a,{item:!0,xs:4},g.a.createElement("span",{className:b.label},"Event Link"),":"," ",g.a.createElement("a",{href:A.eventUrl,target:"_blank",rel:"noopener noreferrer"},"Event Log")),A.failErrorMessage&&g.a.createElement(o.a,{item:!0,xs:12},g.a.createElement("span",{className:b.label},"Fail Error"),":"," ",g.a.createElement("span",{className:b.alert},A.failErrorMessage))),(null===A||void 0===A?void 0:A.dependencies)&&"dep"===W&&g.a.createElement("div",{className:b.paper},(null===A||void 0===A||null===(t=A.dependencies)||void 0===t?void 0:t.python)&&g.a.createElement(O.a,{title:"Python Dependencies"},g.a.createElement("div",{style:{display:"flex",justifyItems:"space-around",flexWrap:"wrap"}},A.dependencies.python.map((function(e){return g.a.createElement(k.a,{type:"deps",status:e.startsWith("http")?Object(N.a)(e,30):e,key:e})})))),(null===A||void 0===A||null===(n=A.dependencies)||void 0===n?void 0:n.java)&&g.a.createElement(O.a,{title:"Java Dependencies"},g.a.createElement(i.a,null,g.a.createElement(s.a,null,g.a.createElement(m.a,null,g.a.createElement(d.a,null,["Name","Version","URL"].map((function(e){return g.a.createElement(u.a,{align:"center",key:e},e)})))),g.a.createElement(p.a,null,A.dependencies.java.map((function(e){var a=e.name,t=e.version,n=e.url;return g.a.createElement(d.a,{key:n},g.a.createElement(u.a,{align:"center"},a),g.a.createElement(u.a,{align:"center"},t),g.a.createElement(u.a,{align:"center"},g.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},n)))}))))))),"worker"===W&&g.a.createElement("div",null,g.a.createElement(i.a,{className:b.paper},g.a.createElement(y.b,{workers:S.jobWorkers,actorMap:T||{}}))),"actor"===W&&g.a.createElement("div",null,g.a.createElement(i.a,{className:b.paper},g.a.createElement(h.a,{actors:T||{},workers:S.jobWorkers}))))):g.a.createElement("div",{className:b.root},g.a.createElement(j.a,{loading:J.startsWith("Loading")}),g.a.createElement(O.a,{title:"JOB - ".concat(R.id)},g.a.createElement(k.a,{type:"job",status:"LOADING"}),g.a.createElement("br",null),"Auto Refresh:",g.a.createElement(r.a,{checked:B,onChange:P,name:"refresh",inputProps:{"aria-label":"secondary checkbox"}}),g.a.createElement("br",null),"Request Status: ",J," ",g.a.createElement("br",null)))}}}]);
//# sourceMappingURL=7.8d10442f.chunk.js.map