(this["webpackJsonpray-dashboard-client"]=this["webpackJsonpray-dashboard-client"]||[]).push([[5],{513:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var n=a(161),r=a(493),o=a(499),l=a(487),c=a(500),i=a(0),s=a.n(i),u=Object(n.a)((function(e){return{search:{margin:e.spacing(1),marginTop:0}}})),d=function(e){var t=e.label,a=e.onChange,n=e.defaultValue,l=u();return s.a.createElement(r.a,{className:l.search,size:"small",label:t,InputProps:{onChange:function(e){var t=e.target.value;a&&a(t)},defaultValue:n,endAdornment:s.a.createElement(o.a,{position:"end"},s.a.createElement(c.a,null))}})},m=function(e){var t=e.label,a=e.onChange,n=e.options,o=u();return s.a.createElement(r.a,{className:o.search,size:"small",label:t,select:!0,SelectProps:{onChange:function(e){var t=e.target.value;a&&a(t)},style:{width:100}}},s.a.createElement(l.a,{value:""},"All"),n.map((function(e){return"string"===typeof e?s.a.createElement(l.a,{value:e},e):s.a.createElement(l.a,{value:e[0]},e[1])})))}},514:function(e,t,a){"use strict";var n=a(438),r=a(485),o=a(0),l=a.n(o);t.a=function(e){var t=e.loading;return l.a.createElement(n.a,{open:t,style:{zIndex:100}},l.a.createElement(r.a,{color:"primary"}))}},517:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l}));var n=a(43),r=function(){return Object(n.b)("api/jobs/")},o=function(e){return Object(n.b)("jobs/".concat(e))},l=function(e){var t=e?"?job_id=".concat(e):"";return Object(n.b)("api/progress".concat(t))}},520:function(e,t,a){"use strict";var n=a(1),r=a(2),o=a(0),l=(a(5),a(3)),c=a(4),i=o.forwardRef((function(e,t){var a=e.classes,c=e.className,i=e.component,s=void 0===i?"div":i,u=Object(r.a)(e,["classes","className","component"]);return o.createElement(s,Object(n.a)({ref:t,className:Object(l.a)(a.root,c)},u))}));t.a=Object(c.a)({root:{width:"100%",overflowX:"auto"}},{name:"MuiTableContainer"})(i)},521:function(e,t,a){"use strict";var n=a(1),r=a(2),o=a(0),l=(a(5),a(3)),c=a(4),i=a(9),s=a(6),u=a(112),d=o.forwardRef((function(e,t){var a=e.classes,c=e.className,i=e.color,d=void 0===i?"secondary":i,m=e.edge,g=void 0!==m&&m,p=e.size,b=void 0===p?"medium":p,h=Object(r.a)(e,["classes","className","color","edge","size"]),f=o.createElement("span",{className:a.thumb});return o.createElement("span",{className:Object(l.a)(a.root,c,{start:a.edgeStart,end:a.edgeEnd}[g],"small"===b&&a["size".concat(Object(s.a)(b))])},o.createElement(u.a,Object(n.a)({type:"checkbox",icon:f,checkedIcon:f,classes:{root:Object(l.a)(a.switchBase,a["color".concat(Object(s.a)(d))]),input:a.input,checked:a.checked,disabled:a.disabled},ref:t},h)),o.createElement("span",{className:a.track}))}));t.a=Object(c.a)((function(e){return{root:{display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},edgeStart:{marginLeft:-8},edgeEnd:{marginRight:-8},switchBase:{position:"absolute",top:0,left:0,zIndex:1,color:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[400],transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),"&$checked":{transform:"translateX(20px)"},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{opacity:.5},"&$disabled + $track":{opacity:"light"===e.palette.type?.12:.1}},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(i.c)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.primary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(i.c)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.secondary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},sizeSmall:{width:40,height:24,padding:7,"& $thumb":{width:16,height:16},"& $switchBase":{padding:4,"&$checked":{transform:"translateX(16px)"}}},checked:{},disabled:{},input:{left:"-100%",width:"300%"},thumb:{boxShadow:e.shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"},track:{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white,opacity:"light"===e.palette.type?.38:.3}}}),{name:"MuiSwitch"})(d)},525:function(e,t,a){"use strict";var n=a(47);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(0)),o=(0,n(a(50)).default)(r.default.createElement("path",{d:"M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"}),"HelpOutline");t.default=o},531:function(e,t,a){"use strict";a.r(t);var n=a(49),r=a(521),o=a(520),l=a(483),c=a(481),i=a(482),s=a(480),u=a(440),d=a(484),m=a(161),g=a(504),p=a(0),b=a.n(p),h=a(514),f=a(513),v=a(110),E=a(444),j=a(427),y=a(525),k=a.n(y),O=Object(m.a)((function(e){return Object(E.a)({root:{backgroundColor:e.palette.background.paper,border:"1px solid #dadde9",color:e.palette.text.primary,padding:e.spacing(1.5)}})})),w=function(e){var t=O();return b.a.createElement(j.a,Object.assign({classes:{tooltip:t.root}},e))},C=Object(m.a)((function(e){return Object(E.a)({helpIcon:{color:e.palette.grey[500]}})})),x=function(e){var t=e.children,a=e.className,n=C();return b.a.createElement(w,{className:a,interactive:!0,title:t},b.a.createElement(k.a,{fontSize:"small",className:n.helpIcon}))},N=a(18),S=a(15),R=a(8),I=a.n(R),L=a(16),T=a(83),z=a(7),$=a(81),D=a(517),_=a(64),M=a.n(_),A=a(67),P=a(108),F=a(160),Y=Object(m.a)((function(e){return Object(E.a)({root:{display:"flex",flexDirection:"column"},legendRoot:{display:"flex",flexDirection:"row",marginBottom:e.spacing(2)},legendItemContainer:{display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center","&:not(:first-child)":{marginLeft:e.spacing(1.5)},"&:not(:last-child)":{marginRight:e.spacing(1.5)}},colorLegend:{width:16,height:16,borderRadius:4,marginRight:e.spacing(1)},progressBarRoot:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"100%",height:8,backgroundColor:"white",borderRadius:6,overflow:"hidden"},segment:{"&:not(:last-child)":{marginRight:1}}})})),B=function(e){var t=e.progress,a=e.total,r=e.unaccountedLabel,o=e.showLegend,l=void 0===o||o,c=e.showTooltip,i=void 0!==c&&c,s=Y(),u=t.reduce((function(e,t){return e+t.value}),0),d=null!==a&&void 0!==a?a:u,m=(u<d?[].concat(Object(T.a)(t),[{value:d-u,label:null!==r&&void 0!==r?r:"unaccounted",color:"#EEEEEE"}]):t).filter((function(e){return e.value}));return b.a.createElement("div",{className:s.root},l&&b.a.createElement("div",{className:s.legendRoot},b.a.createElement("div",{className:s.legendItemContainer},b.a.createElement("div",{className:s.colorLegend,style:{backgroundColor:"black"}}),b.a.createElement(n.a,null,"Total: ",d)),m.map((function(e){var t=e.value,a=e.label,r=e.color;return b.a.createElement("div",{key:a,className:s.legendItemContainer},b.a.createElement("div",{className:s.colorLegend,style:{backgroundColor:r}}),b.a.createElement(n.a,null,a,": ",t))}))),b.a.createElement(W,{showTooltip:i,total:d,segments:m},b.a.createElement("div",{className:s.progressBarRoot,style:{backgroundColor:0===u?"lightGrey":"white"}},m.map((function(e){var t=e.color,a=e.label,n=e.value;return b.a.createElement("span",{key:a,className:s.segment,style:{flex:n,backgroundColor:t},"data-testid":"progress-bar-segment"})})))))},J=Object(m.a)((function(e){return Object(E.a)({legendItemContainer:{display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center","&:not(:first-child)":{marginTop:e.spacing(1)}},colorLegend:{width:16,height:16,borderRadius:4,marginRight:e.spacing(1)}})})),W=function(e){var t=e.showTooltip,a=e.segments,r=e.total,o=e.children,l=J();return t?b.a.createElement(w,{placement:"right",title:b.a.createElement(F.a,null,b.a.createElement("div",{className:l.legendItemContainer},b.a.createElement("div",{className:l.colorLegend,style:{backgroundColor:"black"}}),b.a.createElement(n.a,null,"Total: ",r)),a.map((function(e){var t=e.value,a=e.label,r=e.color;return b.a.createElement("div",{key:a,className:l.legendItemContainer},b.a.createElement("div",{className:l.colorLegend,style:{backgroundColor:r}}),b.a.createElement(n.a,null,a,": ",t))})))},o):o},H=function(e){var t=e.numFinished,a=void 0===t?0:t,n=e.numRunning,r=void 0===n?0:n,o=e.numPendingArgsAvail,l=void 0===o?0:o,c=e.numPendingNodeAssignment,i=void 0===c?0:c,s=e.numSubmittedToWorker,u=void 0===s?0:s,d=e.numUnknown,m=void 0===d?0:d,g=e.showAsComplete,p=void 0!==g&&g,h=e.showTooltip,f=void 0===h||h,v=Object(P.a)();if(p){var E=a+r+l+i+u+m;return b.a.createElement(B,{progress:[{label:"Finished",value:E,color:v.palette.success.main}],showLegend:!1,showTooltip:f})}var j=[{label:"Finished",value:a,color:v.palette.success.main},{label:"Running",value:r,color:v.palette.primary.main},{label:"Waiting for scheduling",value:i+u,color:"#cfcf08"},{label:"Waiting for dependencies",value:l,color:"#f79e02"},{label:"Unknown",value:m,color:"#5f6469"}];return b.a.createElement(B,{progress:j,showLegend:!1,showTooltip:f})},U=function(e){var t,a=e.job,n=a.job_id,r=a.submission_id,o=a.driver_info,l=a.type,c=a.status,u=a.start_time,d=a.end_time,m=Object(p.useContext)($.a).ipLogMap,g=function(e){var t=Object(p.useState)(),a=Object(z.a)(t,2),n=a[0],r=a[1],o=Object(p.useState)("Loading progress..."),l=Object(z.a)(o,2),c=l[0],i=l[1],s=Object(p.useState)(!1),u=Object(z.a)(s,2),d=u[0],m=u[1],g=Object(p.useState)(!0),b=Object(z.a)(g,2),h=b[0],f=b[1],v=Object(p.useRef)(h),E=Object(p.useRef)();v.current=h;var j=Object(p.useCallback)(Object(L.a)(I.a.mark((function t(){var a;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(v.current){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(D.c)(e);case 4:(a=t.sent)&&(a.data.result?r(a.data.data.detail):m(!0),i(a.data.msg)),E.current=setTimeout(j,4e3);case 7:case"end":return t.stop()}}),t)}))),[e]);return Object(p.useEffect)((function(){return j(),function(){E.current&&clearTimeout(E.current)}}),[j]),{progress:n,msg:c,error:d,isRefreshing:h,onSwitchChange:function(e){f(e.target.checked)}}}(null!==n&&void 0!==n?n:void 0),h=g.progress,f=g.error,v=!h||f?"SUCCEEDED"===c||"FAILED"===c?b.a.createElement(H,{numFinished:1,showTooltip:!1}):"unavailable":"SUCCEEDED"===c||"FAILED"===c?b.a.createElement(H,Object.assign({},h,{showAsComplete:!0})):b.a.createElement(H,h);return b.a.createElement(i.a,null,b.a.createElement(s.a,{align:"center"},null!==n&&void 0!==n?n:"-"),b.a.createElement(s.a,{align:"center"},null!==r&&void 0!==r?r:"-"),b.a.createElement(s.a,{align:"center"},c),b.a.createElement(s.a,{align:"center"},v),b.a.createElement(s.a,{align:"center"},o&&m[o.node_ip_address]?b.a.createElement(A.b,{to:"/log/".concat(encodeURIComponent(m[o.node_ip_address]),"?fileName=").concat("DRIVER"===l?n:"driver-".concat(r)),target:"_blank"},"Log"):"-"),b.a.createElement(s.a,{align:"center"},M()(Number(u)).format("YYYY/MM/DD HH:mm:ss")),b.a.createElement(s.a,{align:"center"},d&&d>0?M()(Number(d)).format("YYYY/MM/DD HH:mm:ss"):"-"),b.a.createElement(s.a,{align:"center"},null!==(t=null===o||void 0===o?void 0:o.pid)&&void 0!==t?t:"-"))},V=Object(m.a)((function(e){return{root:{padding:e.spacing(2),width:"100%"},progressError:{marginTop:e.spacing(1)},helpInfo:{marginLeft:e.spacing(1)}}})),X=[{label:"Job ID"},{label:"Submission ID"},{label:"Status"},{label:"Tasks",helpInfo:b.a.createElement(n.a,null,"The progress of the all submitted tasks per job. Tasks that are not yet submitted will not show up in the progress bar.",b.a.createElement("br",null),b.a.createElement("br",null),"Note: This column requires that prometheus is running. See"," ",b.a.createElement("a",{href:"https://docs.ray.io/en/latest/ray-observability/ray-metrics.html#exporting-metrics"},"here")," ","for instructions.")},{label:"Logs"},{label:"StartTime"},{label:"EndTime"},{label:"Driver Pid"}];t.default=function(){var e=V(),t=function(){var e=Object(p.useState)([]),t=Object(z.a)(e,2),a=t[0],n=t[1],r=Object(p.useState)({pageSize:10,pageNo:1}),o=Object(z.a)(r,2),l=o[0],c=o[1],i=Object(p.useState)("Loading the job list..."),s=Object(z.a)(i,2),u=s[0],d=s[1],m=Object(p.useState)(!0),g=Object(z.a)(m,2),b=g[0],h=g[1],f=Object(p.useContext)($.a).ipLogMap,v=Object(p.useState)([]),E=Object(z.a)(v,2),j=E[0],y=E[1],k=Object(p.useRef)(b),O=Object(p.useRef)();k.current=b;var w=Object(p.useCallback)(Object(L.a)(I.a.mark((function e(){var t;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.current){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(D.b)();case 4:(t=e.sent)&&(n(t.data.sort((function(e,t){var a,n;return(null!==(a=t.start_time)&&void 0!==a?a:0)-(null!==(n=e.start_time)&&void 0!==n?n:0)}))),d("Fetched jobs")),O.current=setTimeout(w,4e3);case 7:case"end":return e.stop()}}),e)}))),[]);return Object(p.useEffect)((function(){return w(),function(){O.current&&clearTimeout(O.current)}}),[w]),{jobList:a.filter((function(e){return j.every((function(t){var a;return e[t.key]&&(null!==(a=e[t.key])&&void 0!==a?a:"").includes(t.val)}))})),msg:u,isRefreshing:b,onSwitchChange:function(e){h(e.target.checked)},changeFilter:function(e,t){var a=j.find((function(t){return t.key===e}));a?a.val=t:j.push({key:e,val:t}),y(Object(T.a)(j))},page:l,originalJobs:a,setPage:function(e,t){return c(Object(S.a)(Object(S.a)({},l),{},Object(N.a)({},e,t)))},ipLogMap:f}}(),a=t.msg,n=t.isRefreshing,m=t.onSwitchChange,E=t.jobList,j=t.changeFilter,y=t.page,k=t.setPage;return b.a.createElement("div",{className:e.root},b.a.createElement(h.a,{loading:a.startsWith("Loading")}),b.a.createElement(v.a,{title:"JOBS"},"Auto Refresh:",b.a.createElement(r.a,{checked:n,onChange:function(e){m(e)},name:"refresh",inputProps:{"aria-label":"secondary checkbox"}}),b.a.createElement("br",null),"Request Status: ",a),b.a.createElement(v.a,{title:"Job List"},b.a.createElement(o.a,null,b.a.createElement(f.a,{label:"Job ID",onChange:function(e){return j("job_id",e)}}),b.a.createElement(f.a,{label:"Page Size",onChange:function(e){return k("pageSize",Math.min(Number(e),500)||10)}}),b.a.createElement("div",null,b.a.createElement(g.a,{count:Math.ceil(E.length/y.pageSize),page:y.pageNo,onChange:function(e,t){return k("pageNo",t)}})),b.a.createElement(l.a,null,b.a.createElement(c.a,null,b.a.createElement(i.a,null,X.map((function(t){var a=t.label,n=t.helpInfo;return b.a.createElement(s.a,{align:"center",key:a},b.a.createElement(u.a,{display:"flex",justifyContent:"center",alignItems:"center"},a,n&&b.a.createElement(x,{className:e.helpInfo},n)))})))),b.a.createElement(d.a,null,E.slice((y.pageNo-1)*y.pageSize,y.pageNo*y.pageSize).map((function(e,t){var a,n=e.job_id,r=e.submission_id;return b.a.createElement(U,{key:null!==(a=null!==n&&void 0!==n?n:r)&&void 0!==a?a:t,job:e})})))))))}}}]);
//# sourceMappingURL=5.d5fdb247.chunk.js.map