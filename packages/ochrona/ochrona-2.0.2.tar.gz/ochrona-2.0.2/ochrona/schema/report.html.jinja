<html>
    <head>
        <style>
            body {
              background-color: white;
              font-family: "Roboto", sans-serif;
            }
            .header {
                padding: 5px;
                background: #196fa8;
            }
            .header_container {
                margin-top: -20px;
                background: #196fa8;
                font-size: 18px;
                color: white;
                text-align: center;
            }
            .file_desc {
                background: lightgray;
                font-size: 16px;
                padding: 5px;
            }
            #icon {
                left: 5px;
                top: 5px;
            }
            .dependencies, .vulnerabilities, .policies, .sast, .sbom {
                margin: auto;
                display: block;
                text-align: center;
                width: 90%;
            }
            .pass {
                color: green;
                font-size: 16px;
                font-weight: 600;
            }
            .fail {
                color: red;
                font-size: 16px;
                font-weight: 600;
            }
            table {
                text-align: center;
                width: 100%;
                border-collapse: collapse;
            }
            td, th {
                text-align: left;
                padding: 12px;
                border-bottom: 1px solid #196fa8;
                box-sizing: border-box;
            }
            a {
                color: #196fa8;
                text-decoration: none;
            }
            small {
                text-align: left;
            }
            pre code {
                background-color: lightgray;
                border: 1px solid lightgray;
                display: block;
                padding: 20px;
                width: 90%;
                font-size: 12px;
                margin: auto;
                text-align: left;
            }
            .footer {
                background: #196fa8;
                color: white;
                text-align: center;
            }
            #linkback {
                color: white;
                text-decoration: underline;
            }
            </style>
    </head>
    <body>
        <div class="header">
            <svg id="icon" width="50px" data-name="1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><defs><style>.cls-1{fill:#fff;}</style></defs><title>OC1_3</title><path class="cls-1" d="M500,199.27c-166.09,0-300.73,134.64-300.73,300.73,0,117.67,67.63,219.49,166.1,268.89.47.24.93.49,1.4.72,2.86,1.41,5.74,2.76,8.64,4.08,1.21.55,2.4,1.1,3.61,1.63q4,1.75,8,3.39l4.56,1.8c2.56,1,5.12,2,7.71,2.89,1.74.61,3.51,1.19,5.26,1.77,2.47.83,4.93,1.68,7.43,2.44s5.12,1.47,7.69,2.18q5.06,1.41,10.2,2.63c2.58.62,5.16,1.25,7.78,1.8,2,.42,4,.79,6.07,1.17,2.58.49,5.17,1,7.78,1.39,2,.33,4,.62,6.05.91q4.08.57,8.2,1c1.92.22,3.84.43,5.78.62,3.06.28,6.13.5,9.21.7,1.65.1,3.29.24,4.94.31,4.66.22,9.35.35,14.07.36H500c4.64,0,9.23-.15,13.81-.36,1.16,0,2.31-.11,3.47-.18,4.12-.23,8.23-.53,12.32-.93l1.42-.13c4.52-.46,9-1,13.46-1.71,1.05-.15,2.09-.33,3.14-.49,3.79-.61,7.55-1.27,11.28-2l2.32-.44q6.5-1.35,12.89-3l2.92-.78q5.23-1.38,10.38-2.94l3-.91q6.13-1.93,12.15-4.11c.94-.34,1.87-.72,2.81-1.07q4.8-1.78,9.51-3.75c1.19-.49,2.39-1,3.57-1.49,3.8-1.63,7.56-3.31,11.27-5.09.93-.45,1.84-.93,2.76-1.38q4.37-2.15,8.64-4.42l4.06-2.2q4.39-2.43,8.71-5c1.68-1,3.34-2,5-3.07,2.44-1.53,4.88-3.07,7.27-4.66,1.71-1.14,3.39-2.3,5.07-3.47s3.56-2.51,5.33-3.79,3.53-2.57,5.26-3.89,3.19-2.49,4.78-3.75q5-4,9.83-8.14c1.15-1,2.32-2,3.46-3,2-1.78,4-3.6,5.9-5.43,1-.93,2-1.86,2.94-2.8,2.06-2,4.1-4,6.1-6l.87-.91a299.65,299.65,0,0,0,85-209.4C800.73,333.91,666.09,199.27,500,199.27ZM633.09,515.51a298,298,0,0,1-22.76,53.86q-6.93,12.78-15,24.78-4,6-8.38,11.77-8.65,11.58-18.36,22.26A302,302,0,0,1,502,683.11c-2.63,1.6-5.37,3-8.05,4.53h0a301.82,301.82,0,0,1-47.64-33.49l-.49-.43a302.71,302.71,0,0,1-39.5-41.17L405,611c-3.78-4.82-7.43-9.74-10.9-14.8L394,596q-5.43-7.9-10.36-16.16l-.62-1.09c-2.86-4.82-5.55-9.74-8.14-14.73-.55-1.06-1.09-2.12-1.63-3.18-2.56-5.1-5-10.26-7.28-15.51-.15-.35-.31-.68-.46-1q-3.63-8.46-6.72-17.2c-.41-1.14-.78-2.3-1.17-3.45q-2.38-6.95-4.43-14c-.44-1.53-.89-3.06-1.31-4.6-1.47-5.4-2.81-10.85-4-16.38-.1-.47-.23-.94-.33-1.42-1.23-5.95-2.24-12-3.11-18.06-.24-1.65-.42-3.31-.63-5q-.89-6.92-1.44-13.94c-.14-1.79-.3-3.58-.41-5.38-.38-6.2-.64-12.44-.64-18.74,0-9.85.54-19.57,1.46-29.18a298.76,298.76,0,0,1,153.39-44.63c1.28,0,2.55-.1,3.83-.1a299,299,0,0,1,144.2,36.82,299.33,299.33,0,0,1-11.15,126.43Z"/></svg>
            <div class="header_container">
                <h1> Ochrona Dependency Analysis</h1>
            </div>
        </div>
        <div class="file_desc">
            <span><b>Report:</b> {{ idx or '0' }} of {{ total or 'Unknown' }}</span></br>
            <span><b>File Analyzed:</b> {{ file_name or 'Unknown' }}</span></br>
            <span><b>Report Time:</b> {{ timestamp or 'Unknown' }}</span>
        </div>
        <div class="dependencies">
            <h3>Dependency List</h3>
            <table>
                <tr>
                    <th></th>
                    <th>Version</th>
                    <th>License</th>
                    <th>Summary</th>
                    <th>purl</th>
                </tr>
                {% for dep in dependencies %}
                    <tr>
                        <th> <a href='{{ dep.url }}'>{{ dep.name }} üîó</a> </th>
                        <td> {{ dep.full }} </td>
                        <td> {{ dep.license_type }} </td>
                        <td> {{ dep.summary }} </td>
                        <td> {{ dep.purl }} </td>
                    </tr>
                {% endfor %}
            </table>
        </div></br>
        <div class="vulnerabilities">
            <h3>Vulnerability Checks</h3>
            {% if vulnerabilities %}
                <p class="fail">‚ùå Dependency Vulnerabilities Found</p>
                <table>
                    <tr>
                        <th></th>
                        <th>Vulnerability ID</th>
                        <th>Published</th>
                        <th>Severity</th>
                        <th>Description</th>
                    </tr>
                    {% for vuln in vulnerabilities %}
                        <tr>
                            <th> {{ vuln.name }} </th>
                            {% if "CVE" in vuln.cve_id %}
                                <td><a href='https://nvd.nist.gov/vuln/detail/{{ vuln.cve_id }}'>{{ vuln.cve_id }}</a></td>
                            {% else %}
                                <td> {{ vuln.cve_id }} </td>
                            {% endif %}
                            <td> {{ vuln.publish_date }} </td>
                            <td> {{ vuln.ochrona_severity_score }} </td>
                            <td> {{ vuln.description }} </td>
                        </tr>
                    {% endfor %}
                </table>
            {% else %}
                <p class="pass">‚úÖ No Dependency Vulnerabilities Found</p>
            {% endif %}
        </div></br>
        <div class="policies">
            <h3>Policy Checks</h3>
            {% if policy_violations %}
                <p class="fail">‚ùå Policy Violations Found</p>
                <table>
                    <tr>
                        <th>Policy Definition</th>
                        <th>Violation Details</th>
                    </tr>
                    {% for pv in policy_violations %}
                        <tr>
                            <td> {{ pv.friendly_policy_type }} </td>
                            <td> {{ pv.message }} </td>
                        </tr>
                    {% endfor %}
                </table>
            {% else %}
                <p class="pass">‚úÖ No Policy Violations Found</p>
            {% endif %}
        </div></br>
        {% if sast_violations %}
            <div class="sast">
                <h3>Static Analysis Checks</h3>
                {% if sast_violations %}
                    <p class="fail">‚ùå SAST Violations Found</p>
                    <table>
                        <tr>
                            <th>Location</th>
                            <th>Severity</th>
                            <th>Confidence</th>
                            <th>Details</th>
                        </tr>
                        {% for sv in sast_violations %}
                            <tr>
                                <td> {{ sv.location }} </td>
                                <td> {{ sv.severity }} </td>
                                <td> {{ sv.confidence }} </td>
                                <td> {{ sv.message }} </td>
                            </tr>
                        {% endfor %}
                    </table>
                {% else %}
                    <p class="pass">‚úÖ No SAST Violations Found</p>
                {% endif %}
            </div></br>
        {% endif %}
        <div class="sbom">
            <h3>Software Bill of Materials (SBOM)</h3>
            <small>Software Bill-of-Materials (SBOM) are a list of the components used to build a piece of software. They aim to make the delivery and composition of software components more transparent. These documents can be useful for understanding software supply chains and ensuring license complaince. Ochrona has opted to support <a href="https://cyclonedx.org/">CycloneDX</a> as our SBOM standard of choice. CycloneDX is a lightweight software bill of materials (SBOM) standard designed for use in application security contexts and supply chain component analysis. CycloneDX is developed and support by <a href="https://owasp.org/www-project-cyclonedx/">OWASP</a>.</small>
            <pre>
                <code>
                    {{ sbom }}
                </code>
            </pre>
        </div></br>
        <div class="footer">
            <small>This report was generated using <a id="linkback" href="https://github.com/ochronasec/ochrona-cli">Ochrona</a>.</small>
        </div>
        <p style="page-break-after: always;"></p>
    </body>
</html>
