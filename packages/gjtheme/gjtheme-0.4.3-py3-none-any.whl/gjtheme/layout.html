{#
    gjtheme/layout.html
    ~~~~~~~~~~~~~~~~~~~

    Master layout template for GJ themes.

    :copyright: Copyright 2017-2022 by Grant Jenks.
    :license: Apache 2.0, see LICENSE for details.
#}
{% extends "basic/layout.html" %}

{%- macro gj_sidebar() %}
  {%- if render_sidebar %}
    <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
      <div class="sphinxsidebarwrapper">
        {%- block sidebarlogo %}
          {%- if logo %}
            <p class="logo"><a href="{{ pathto(master_doc) }}">
              <img class="logo" src="{{ pathto('_static/' + logo, 1) }}" alt="Logo"/>
            </a></p>
          {%- endif %}
        {%- endblock %}
        {%- if sidebars != None %}
          {#- new style sidebar: explicitly include/exclude templates #}
          {%- for sidebartemplate in sidebars %}
            {%- include sidebartemplate %}
          {%- endfor %}
        {%- else %}
          {#- old style sidebars: using blocks -- should be deprecated #}
          {%- block sidebartoc %}
            {%- include "localtoc.html" %}
          {%- endblock %}
          {%- block sidebarrel %}
            {%- include "relations.html" %}
          {%- endblock %}
          {%- block sidebarsourcelink %}
            {%- include "sourcelink.html" %}
          {%- endblock %}
          {%- if customsidebar %}
            {%- include customsidebar %}
          {%- endif %}
          {%- block sidebarsearch %}
            {%- include "searchbox.html" %}
          {%- endblock %}
        {%- endif %}
      </div>
    </div>
  {%- endif %}
{%- endmacro %}

{%- macro gj_script() %}
  <script>
   var DOCUMENTATION_OPTIONS = {
       URL_ROOT:    '{{ url_root }}',
       VERSION:     '{{ release|e }}',
       COLLAPSE_INDEX: false,
       FILE_SUFFIX: '{{ '' if no_search_suffix else file_suffix }}',
       HAS_SOURCE:  {{ has_source|lower }},
       SOURCELINK_SUFFIX: '{{ sourcelink_suffix }}'
   };
  </script>
  {%- for scriptfile in script_files %}
    <script src="{{ pathto(scriptfile, 1) }}"></script>
  {%- endfor %}
{%- endmacro %}

{%- macro gj_css() %}
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <link rel="stylesheet" href="{{ pathto('_static/pygments.css', 1) }}" type="text/css" />
  <link rel="stylesheet" href="{{ pathto('_static/' + style, 1) }}" type="text/css" />
  {%- for css in css_files %}
    {%- if css|attr("rel") %}
      <link rel="{{ css.rel }}" href="{{ pathto(css.filename, 1) }}" type="text/css"{% if css.title is not none %} title="{{ css.title }}"{% endif %} />
    {%- else %}
      <link rel="stylesheet" href="{{ pathto(css, 1) }}" type="text/css" />
    {%- endif %}
  {%- endfor %}
{%- endmacro %}

{%- block doctype %}
  <!DOCTYPE html>
{% endblock %}

{% set html_tag = '<html lang="en">' %}

{%- block htmltitle %}
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ title|striptags|e }} &mdash; Grant Jenks</title>
{%- endblock %}

{%- block csss %}
  {{- gj_css() }}
{%- endblock %}

{%- block scripts %}
  {{- gj_script() }}
{%- endblock %}

{%- block linktags %}
  {%- if hasdoc('about') %}
    <link rel="author" title="{{ _('About these documents') }}" href="{{ pathto('about') }}" />
  {%- endif %}
  {%- if hasdoc('genindex') %}
    <link rel="index" title="{{ _('Index') }}" href="{{ pathto('genindex') }}" />
  {%- endif %}
  {%- if hasdoc('search') %}
    <link rel="search" title="{{ _('Search') }}" href="{{ pathto('search') }}" />
  {%- endif %}
  {%- if hasdoc('copyright') %}
    <link rel="copyright" title="{{ _('Copyright') }}" href="{{ pathto('copyright') }}" />
  {%- endif %}
  {%- if next %}
    <link rel="next" title="{{ next.title|striptags|e }}" href="{{ next.link|e }}" />
  {%- endif %}
  {%- if prev %}
    <link rel="prev" title="{{ prev.title|striptags|e }}" href="{{ prev.link|e }}" />
  {%- endif %}
{%- endblock %}

{%- block extrahead %}
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19364636-2"></script>
  <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
   gtag('config', 'UA-19364636-2');
  </script>
{% endblock %}

{%- block header %}
  <header>
    <a href="/">
      <img src="{{ pathto('_static/grant-jenks-logo.png', 1) }}" alt="Grant Jenks Logo">
    </a>
    <nav>
      <ul>
        <li><a class="link" href="/">Grant Jenks</a></li>
        <li><a class="link" href="/projects/">Projects</a></li>
        <li><a class="link" href="/essays/">Essays</a></li>
        <li><a class="link" href="/talks/">Talks</a></li>
        <li><a class="link" href="/search/">Search</a></li>
      </ul>
    </nav>
  </header>
{% endblock %}

{%- block relbar1 %}{% endblock %}

{%- block content %}
  <article>
    {% block body %}{% endblock %}
  </article>
{%- endblock %}

{%- block relbar2 %}{% endblock %}

{%- block footer %}
  <footer>
    <hr>
    <div class="footer-nav">
      {% set gj_ns = namespace(previous=None, next=None) %}
      {% for rellink in rellinks %}
        {% if rellink[3] == 'previous' %}
          {% set gj_ns.previous = rellink %}
        {% elif rellink[3] == 'next' %}
          {% set gj_ns.next = rellink %}
        {% endif %}
      {% endfor %}
      <div class="nav-cell-1">
        &larr;
        {% if gj_ns.previous %}
          {% set rellink = gj_ns.previous %}
          <a class="link" href="{{ pathto(rellink[0]) }}" title="{{ rellink[1]|striptags|e }}">{{ rellink[1] }}</a>
        {% else %}
          <a class="link" href="/search/" title="Search">Search</a>
        {% endif %}
      </div>
      <div class="nav-cell-2">
        &uarr;
        {% if parents %}
          <a class="link" href="{{ parents[-1]['link'] }}" title="{{ parents[-1]['title']|striptags|e }}">{{ parents[-1]['title'] }}</a>
        {% else %}
          <a class="link" href="/" title="Grant Jenks">Grant Jenks</a>
        {% endif %}
      </div>
      <div class="nav-cell-3">
        {% if gj_ns.next %}
          {% set rellink = gj_ns.next %}
          <a class="link" href="{{ pathto(rellink[0]) }}" title="{{ rellink[1]|striptags|e }}">{{ rellink[1] }}</a>
        {% else %}
          <a class="link" href="/contents/" title="Contents">Contents</a>
        {% endif %}
        &rarr;
      </div
    ></div>
    <hr>
    <ul>
      <li><a class="link" href="/copyright/">Copyright 2009-2022</a> <a class="link" href="/">Grant Jenks</a></li>
      <li><a class="link" href="/rss-feed/">RSS Feed</a></li>
      <li><a class="link" href="/site-index/">Site Index</a></li>
      <li><a class="link" href="/terms-of-use/">Terms of Use</a></li>
      <li><a class="link" href="/privacy-policy/">Privacy Policy</a></li>
    </ul>
  </footer>
{%- endblock %}
