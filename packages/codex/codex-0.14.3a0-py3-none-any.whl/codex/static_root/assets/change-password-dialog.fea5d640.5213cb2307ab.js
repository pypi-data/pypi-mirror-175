import{s as _,k as l,t as m,u as p,_ as f,a as w,b as h,n as g,o as t}from"./submit-footer.4e25f04d.js";import{n as d,b,q as a,r as i,g as P,e as v}from"./main.bc7f684f.js";import{c as u,b as k}from"./confirm-footer.fd7b667d.js";import{_ as n}from"./index.e954868e.js";const y={name:"CloseButton",data(){return{mdiClose:_}}};var C=function(){var s=this,o=s._self._c;return o(u,s._g(s._b({attrs:{icon:"",ripple:""}},"v-btn",s.$attrs,!1),s.$listeners),[o(n,[s._v(s._s(s.mdiClose))])],1)},S=[],$=d(y,C,S,!1,null,null,null,null);const c=$.exports;const L={name:"ChangePasswordDialog",components:{SubmitFooter:l,CloseButton:c},props:{user:{type:Object,required:!0},isAdminMode:{type:Boolean,default:!1}},data(){return{rules:{oldPassword:[e=>!!e||"Old Password is required"],password:[e=>e?e.length<this.MIN_PASSWORD_LENGTH?`Password must be ${this.MIN_PASSWORD_LENGTH} characters long`:e===this.credentials.oldPassword?"New password must be different than old password":!0:"New Password is required"],passwordConfirm:[e=>e===this.credentials.password||"Passwords must match"]},credentials:{oldPassword:"",password:"",passwordConfirm:""},submitButtonEnabled:!1,showDialog:!1,mdiLockReset:m,mdiLockPlusOutline:p}},computed:{...b(a,{formErrors:e=>e.form.errors,formSuccess:e=>e.form.success,MIN_PASSWORD_LEN:e=>e.MIN_PASSWORD_LEN})},watch:{showDialog(e){if(e){const s=this.$refs.form;s&&s.reset(),this.clearErrors()}},credentials:{handler(){const e=this.$refs.form;this.submitButtonEnabled=e&&e.validate()},deep:!0}},mounted(){window.addEventListener("keyup",this._keyListener)},unmounted(){window.removeEventListener("keyup",this._keyListener)},methods:{...i(P,["changePassword"]),...i(a,["clearErrors"]),submit:function(){!this.$refs.form.validate()||(this.isAdminMode?v().changeUserPassword(this.user.pk,this.credentials).catch(console.error):this.changePassword(this.credentials).catch(console.error))},_keyListener(e){e.stopImmediatePropagation()}}};var D=function(){var s=this,o=s._self._c;return s.user?o(k,{attrs:{origin:"center-top",transition:"slide-y-transition","max-width":"22em","overlay-opacity":"0.5"},scopedSlots:s._u([{key:"activator",fn:function({on:r}){return[s.isAdminMode?o(u,s._g({attrs:{icon:"",ripple:""}},r),[o(n,[s._v(" "+s._s(s.mdiLockPlusOutline))])],1):o(f,s._g({attrs:{ripple:""}},r),[o(w,[o(h,[o(n,[s._v(s._s(s.mdiLockReset))]),s._v("Change Password")],1)],1)],1)]}}],null,!1,2654908034),model:{value:s.showDialog,callback:function(r){s.showDialog=r},expression:"showDialog"}},[s.formSuccess?o("div",{staticClass:"codexFormSuccess"},[s._v(" "+s._s(s.formSuccess)+" "),o(c,{on:{click:function(r){s.showDialog=!1}}})],1):o(g,{ref:"form",staticClass:"changePasswordDialog"},[o("h2",[s._v("User "+s._s(s.user.username))]),o("input",{staticClass:"hidden",attrs:{name:"username",autocomplete:"username",disabled:"",type:"text"},domProps:{value:s.user.username}}),s.isAdminMode?s._e():o(t,{ref:"oldPassword",attrs:{autocomplete:"current-password",label:"Old Password",rules:s.rules.oldPassword,clearable:"",type:"password",autofocus:""},on:{keydown:function(r){return!r.type.indexOf("key")&&s._k(r.keyCode,"enter",13,r.key,"Enter")?null:s.$refs.password.focus()}},model:{value:s.credentials.oldPassword,callback:function(r){s.$set(s.credentials,"oldPassword",r)},expression:"credentials.oldPassword"}}),o(t,{ref:"password",attrs:{autocomplete:"new-password",label:"New Password",rules:s.rules.password,clearable:"",type:"password",autofocus:s.isAdminMode},on:{keydown:function(r){return!r.type.indexOf("key")&&s._k(r.keyCode,"enter",13,r.key,"Enter")?null:s.$refs.passwordConfirm.focus()}},model:{value:s.credentials.password,callback:function(r){s.$set(s.credentials,"password",r)},expression:"credentials.password"}}),o(t,{ref:"passwordConfirm",attrs:{autocomplete:"new-password",label:"Confirm Password",rules:s.rules.passwordConfirm,clearable:"",type:"password"},model:{value:s.credentials.passwordConfirm,callback:function(r){s.$set(s.credentials,"passwordConfirm",r)},expression:"credentials.passwordConfirm"}}),o(l,{attrs:{verb:"Change",table:"Password",disabled:!s.submitButtonEnabled},on:{submit:s.submit,cancel:function(r){s.showDialog=!1}}})],1)],1):s._e()},E=[],x=d(L,D,E,!1,null,"123ff526",null,null);const R=x.exports;export{R as _,c as a};
