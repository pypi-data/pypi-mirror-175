import{A as c,a as h,b,_ as n}from"./relation-picker.8b4881f1.js";import{a4 as i,f as l,e as s,b as u,r as p,n as d}from"./main.a046e816.js";import{o as f}from"./submit-footer.43a05fcc.js";import{_ as g}from"./VSimpleTable.b189b4fe.js";import"./VSubheader.f1e279d6.js";import"./index.3036afcc.js";import"./confirm-footer.2f15428c.js";import"./confirm-dialog.ffa801be.js";import"./VSelect.053c34a7.js";import"./VInput.039cebfc.js";const m=["name","userSet","librarySet"];Object.freeze(m);const o={name:"",userSet:[],librarySet:[]};Object.freeze(o);const v={name:"AdminGroupCreateUpdateInputs",components:{AdminRelationPicker:c},props:{oldRow:{type:[Object,Boolean],default:!1}},emits:["change"],data(){return{rules:{name:[t=>!!t||"Name is required",t=>!!t&&!this.names.has(t.trim())||"Name already used"]},row:i.cloneDeep(this.oldRow||o)}},computed:{...l(s,["vuetifyLibraries","vuetifyUsers"]),...u(s,{groups:t=>t.groups}),names(){return this.nameSet(this.groups,"name",this.oldRow,!0)}},watch:{row:{handler(t){this.$emit("change",t)},deep:!0},oldRow:{handler(t){this.row=i.cloneDeep(t)},deep:!0}},methods:{...p(s,["nameSet"])},UPDATE_KEYS:m,EMPTY_ROW:o};var y=function(){var e=this,r=e._self._c;return r("div",[r(f,{attrs:{label:"Group Name",rules:e.rules.name,clearable:"",autofocus:""},model:{value:e.row.name,callback:function(a){e.$set(e.row,"name",a)},expression:"row.name"}}),r("AdminRelationPicker",{attrs:{value:e.row.userSet,label:"Users",items:e.vuetifyUsers},on:{change:function(a){e.row.userSet=a}}}),r("AdminRelationPicker",{attrs:{value:e.row.librarySet,label:"Libraries",items:e.vuetifyLibraries},on:{change:function(a){e.row.librarySet=a}}})],1)},A=[],w=d(v,y,A,!1,null,null,null,null);const R=w.exports;const D=96+16,S=36,G=180,H=24,U=D+S+G+H,_=48,k=_*2,E={name:"AdminGroupsTab",components:{AdminDeleteRowDialog:h,AdminCreateUpdateDialog:b,RelationChips:n},props:{innerHeight:{type:Number,required:!0}},data(){return{lastUpdate:{pk:0,field:void 0},AdminGroupCreateUpdateInputs:R}},computed:{...u(s,{groups:t=>t.groups,tableMaxHeight:t=>(t.groups.length+1)*_}),...l(s,["libraryMap","userMap"]),tableHeight(){const t=this.innerHeight-U;return this.tableMaxHeight<t?void 0:Math.max(t,k)}},mounted(){this.loadTables(["User","Library","Group"])},methods:{...p(s,["loadTables"])}};var C=function(){var e=this,r=e._self._c;return r("div",[r("header",{staticClass:"tabHeader"},[r("AdminCreateUpdateDialog",{attrs:{table:"Group","max-width":"20em",inputs:e.AdminGroupCreateUpdateInputs}})],1),r(g,{staticClass:"highlight-simple-table admin-table",attrs:{"fixed-header":"",height:e.tableHeight},scopedSlots:e._u([{key:"default",fn:function(){return[r("thead",[r("tr",[r("th",[e._v("Name")]),r("th",[e._v("Users")]),r("th",[e._v("Libraries")]),r("th",[e._v("Edit")]),r("th",[e._v("Delete")])])]),r("tbody",e._l(e.groups,function(a){return r("tr",{key:`g:${a.pk}:${a.keyHack}`},[r("td",{staticClass:"nameCol"},[e._v(" "+e._s(a.name)+" ")]),r("td",[r(n,{attrs:{pks:a.userSet,map:e.userMap}})],1),r("td",[r(n,{attrs:{pks:a.librarySet,map:e.libraryMap}})],1),r("td",[r("AdminCreateUpdateDialog",{attrs:{table:"Group","old-row":a,"max-width":"20em",inputs:e.AdminGroupCreateUpdateInputs}})],1),r("td",[r("AdminDeleteRowDialog",{attrs:{table:"Group",pk:a.pk,name:a.name}})],1)])}),0)]},proxy:!0}])}),e._m(0)],1)},T=[function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"groupHelp"}},[e("h3",[t._v("Group Logic")]),e("p",[t._v(" A library with no groups is accessible to every user and non-users if those are enabled. ")]),e("p",[t._v(" A library with "),e("em",[t._v("any")]),t._v(" groups is accessible "),e("em",[t._v("only")]),t._v(" to users who are in those groups. ")]),e("p",[t._v(" If you have libraries added and you do not see them in your browser, check to see if the library and your user are in the same group. ")])])}],x=d(E,C,T,!1,null,"b43a8fcb",null,null);const z=x.exports;export{z as default};
