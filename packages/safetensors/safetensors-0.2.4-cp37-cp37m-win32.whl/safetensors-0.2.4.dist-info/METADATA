Metadata-Version: 2.1
Name: safetensors
Version: 0.2.4
Summary: Fast and Safe Tensor serialization
Home-page: https://github.com/huggingface/safetensors
Author: 
Author-email: 
License: Apache License 2.0
Classifier: Development Status :: 5 - Production/Stable
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Education
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: Apache Software License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Description-Content-Type: text/markdown
Provides-Extra: dev
Requires-Dist: black (==22.3) ; extra == 'dev'
Requires-Dist: isort (>=5.5.4) ; extra == 'dev'
Requires-Dist: flake8 (>=3.8.3) ; extra == 'dev'
Requires-Dist: pytest ; extra == 'dev'
Requires-Dist: numpy ; extra == 'dev'
Requires-Dist: setuptools-rust ; extra == 'dev'
Requires-Dist: huggingface-hub ; extra == 'dev'
Provides-Extra: testing
Requires-Dist: black (==22.3) ; extra == 'testing'
Requires-Dist: isort (>=5.5.4) ; extra == 'testing'
Requires-Dist: flake8 (>=3.8.3) ; extra == 'testing'
Requires-Dist: pytest ; extra == 'testing'
Requires-Dist: numpy ; extra == 'testing'
Requires-Dist: setuptools-rust ; extra == 'testing'
Requires-Dist: huggingface-hub ; extra == 'testing'

## Installation

```
pip install safetensors
```


## Usage

### Numpy

```python
from safetensors.numpy import save_file, load_file
import numpy as np

tensors = {
   "a": np.zeros((2, 2)),
   "b": np.zeros((2, 3), dtype=np.uint8)
}

save_file(tensors, "./model.safetensors")


# Now loading
loaded = load_file("./model.safetensors")
```

### Torch

```python
from safetensors.torch import save_file, load_file
import torch

tensors = {
   "a": torch.zeros((2, 2)),
   "b": torch.zeros((2, 3), dtype=torch.uint8)
}

save_file(tensors, "./model.safetensors")


# Now loading
loaded = load_file("./model.safetensors")
```

### Developing

```
pip install setuptools_rust
python setup.py develop
```
Should be enough to install this library locally.

### Testing

```
pip install pytest   # We don't require pytest, but it's a common library used across HF.
pytest -sv tests/
```
