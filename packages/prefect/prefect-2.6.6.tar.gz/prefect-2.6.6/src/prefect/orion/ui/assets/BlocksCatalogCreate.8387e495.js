import{u as R,Y as P,r as N,a6 as B,a_ as $,d as V,b as i,f as q,i as r,o as _,g as d,w as S,h as D,a$ as F,b0 as J,b1 as O,p as Q,b2 as G,q as g,aX as H,b3 as L,aU as U,am as A,b4 as W,G as X}from"./index.52801128.js";import{u as Y}from"./useRouteParam.2cd4d7eb.js";import{u as T}from"./useSubscriptionWithDependencies.bb1e9971.js";import{u as j}from"./usePageTitle.2eedd110.js";function x(t,e=""){var m;const p=R(),n=P(),k=C(e,(m=v(n,t))!=null?m:e),s=N(k),o=B(s,(a,l)=>{z(a,l)||p.push({query:{...n.query,[t]:s.value}})}),y=B(n,(a,l)=>{var u,c;const b=(u=v(a,t))!=null?u:e,h=(c=v(l,t))!=null?c:e,f=C(h,b);f!==s.value&&(s.value=f)},{deep:!0});return $(()=>{o(),y()}),s}function v({query:t},e){return t[e]}function C(t,e){return Array.isArray(t)&&!Array.isArray(e)?[e]:typeof t=="string"&&Array.isArray(e)?e[0]:e}function z(t,e){return JSON.stringify(t)===JSON.stringify(e)}const Z=V({__name:"BlocksCatalogCreate",setup(t){const e=R(),p=x("redirect"),n=Y("blockTypeSlug"),k=i(()=>n.value?[n.value]:null),s=T(H.getBlockTypeBySlug,k),o=i(()=>s.response),y=i(()=>o.value?[o.value.id]:null),m=T(L.getBlockSchemaForBlockType,y),a=i(()=>m.response);function l(u){U.createBlockDocument(u).then(({id:c})=>h(c)).catch(c=>{A("Failed to create block","error"),console.error(c)})}function b(){e.back()}function h(u){if(A("Block created successfully","success"),p.value){const c=e.resolve(W(p.value));e.push(c);return}e.push(X.block(u))}const f=i(()=>o.value?`Create ${o.value.name} Block`:"Create Block");return j(f),(u,c)=>{const w=q("p-layout-default");return r(o)?(_(),d(w,{key:0,class:"blocks-catalog-create"},{header:S(()=>[D(r(F),{"block-type":r(o)},null,8,["block-type"])]),default:S(()=>[r(o)?(_(),d(r(J),{key:0,"block-type":r(o)},{default:S(()=>[r(a)?(_(),d(r(O),Q({key:0,key:r(a).id,"block-schema":r(a)},G({submit:l,cancel:b})),null,16,["block-schema"])):g("",!0)]),_:1},8,["block-type"])):g("",!0)]),_:1})):g("",!0)}}});export{Z as default};
